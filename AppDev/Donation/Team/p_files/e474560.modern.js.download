(window.webpackJsonp=window.webpackJsonp||[]).push([[224],{1622:function(t,e,o){"use strict";var r=o(2),c=o(1),n=(o(68),o(10)),l=o(43),d=o(24),h=o(50);function j(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(object);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,o)}return e}function f(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?j(Object(source),!0).forEach((function(e){Object(c.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):j(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}e.a={mounted(){this.updateProjectData(),this.initMap()},data:()=>({from:null,latestPostVisible:!1}),watch:{$route:"updateRoute",initialMoveend:{handler:"addPopup",immediate:!0},latestPost:{handler:"addPopup",immediate:!0}},computed:f(f(f(f(f({},Object(l.b)({PostRepo:d.n,projectCommodityRepo:d.s})),Object(n.d)("frontend",{getNamespace:"getNamespace"})),Object(n.d)("frontend/project",{project:"project"})),Object(n.f)("frontend/mapbox",{initialMoveend:t=>t.initialMoveend})),{},{projectSlug(){return this.$route.params.project_slug},latestPost(){return this.PostRepo.query().where("project_slug",(t=>t===this.projectSlug)).orderBy("date","desc").orderBy("title").first()},projectActivityTags(){var t,e;return null!==(t=this.project)&&void 0!==t&&null!==(e=t.activity_tags)&&void 0!==e&&e.data?this.project.activity_tags.data.map((t=>t.label)):[]},description(){var t=["".concat(this.project.country,", ").concat(this.project.region)];return this.projectActivityTags.length&&t.push(this.projectActivityTags.join(", ")),t.push(this.project.description),t.join(" Â· ")}}),methods:f(f(f(f({},Object(n.c)("frontend/project",{setProjectSlug:"setProjectSlug",fetchProject:"fetchProject",fetchPosts:"fetchPosts",fetchLegals:"fetchLegals",clear:"clear"})),Object(n.e)("frontend/project",{setLoadStatus:"setLoadStatus",setProject:"setProject",setCallToActionVisibility:"setCallToActionVisibility"})),Object(n.c)("frontend/mapbox",{projectOnEntry:"projectOnEntry",projectOnExit:"projectOnExit",addPostPopup:"addPostPopup",removePostPopup:"removePostPopup"})),{},{updateProjectData(){this.fetchPosts({limit:1}),this.fetchLegals({slug:this.projectSlug})},updateRoute(t,e){var o=this;return Object(r.a)((function*(){if(o.from=e,o.removePopup(),o.setCallToActionVisibility(!1),t.params.project_slug!==e.params.project_slug)try{yield o.projectOnExit()}finally{yield o.$fetch(),o.updateProjectData()}}))()},initMap(){var t=this;return Object(r.a)((function*(){t.project&&t.projectOnEntry({project:t.project})}))()},addPopup(){this.latestPost&&this.initialMoveend&&this.$route.name===this.getNamespace("project")&&!this.latestPostVisible&&(this.addPostPopup({parent:this,id:this.latestPost.id,slug:this.latestPost.slug,image:this.latestPost.image,title:this.latestPost.title,date:this.latestPost.readable_date,point:this.latestPost.point?this.latestPost.point:this.latestPost.spot_point}),this.latestPostVisible=!0)},removePopup(){this.latestPost&&this.initialMoveend&&this.removePostPopup()}}),beforeDestroy(){this.clear(),this.projectCommodityRepo.deleteAll()},beforeRouteLeave(t,e,o){var c=this;return Object(r.a)((function*(){if(!Object(h.a)(t.matched,["frontend"]))return o();try{yield c.projectOnExit()}finally{o()}}))()}}},2072:function(t,e,o){"use strict";o.r(e);var r=o(2),c={mixins:[o(1622).a],fetch(){var t=this;return Object(r.a)((function*(){try{t.setProjectSlug(t.$route.params.project_slug),yield t.fetchProject()}catch(t){throw new Error("The Project you were looking for does not exist.")}t.initMap()}))()}},n=o(0),component=Object(n.a)(c,(function(){var t=this,e=t._self._c;return e("of-frontend-layout-fetch",t._b({},"of-frontend-layout-fetch",t.$fetchState,!1),[e("nuxt-child")],1)}),[],!1,null,null,null);e.default=component.exports}}]);